<!DOCTYPE html>
<html lang="en">
  <%- include("layouts/header") -%>
  <body>
    <!-- Navigation-->
    <%- include("layouts/navbar") -%>

    <!-- Page Header-->
    <header
      class="masthead"
      style="background-image: url('assets/img/Examiner_1.jpg')"
    >
      <div class="container position-relative px-4 px-lg-5">
        <div class="row gx-4 gx-lg-5 justify-content-center">
          <div class="col-md-10 col-lg-8 col-xl-7">
            <div class="page-heading">
              <h1>Examiner</h1>
              <!-- <span class="subheading">Have questions? I have answers.</span> -->
            </div>
            <div id="appointmentsTable">
              <table id="table">
                <tr id="tableHeadingRow">
                  <th id="tableHeading">Username</th>
                  <th id="tableHeading">Appointment Date</th>
                  <th id="tableHeading">Appointment Time</th>
                  <th id="tableHeading">Test Type</th>
                  <th id="tableHeading">Comments</th>
                </tr>
              <% for( let i = 0; i < appointments.length; i++ ) { %>
                <tr id="tableDataRow">
                  <td id="tableData"><a href="/getUserDetails?id=<%= appointments[i]._id %>"><%= appointments[i].firstName ? appointments[i].firstName + " " + appointments[i].lastName : null %></a></td>
                  <td id="tableData"><%= appointments[i].appointmentID ? formatDate(new Date(appointments[i].appointmentID.date)) : null %></td>
                  <td id="tableData"><%= appointments[i].appointmentID ? appointments[i].appointmentID.time : null %></td>
                  <td id="tableData"><%= appointments[i].testType ? appointments[i].testType : null %></td>
                  <td id="tableData"><%= appointments[i].comments ? appointments[i].comments : null %></td>
                </tr>
              <% } %>
              <% function formatDate(appointmentDate) {
                const date = appointmentDate.getDate() + 1;
                const month = appointmentDate.getMonth() + 1;
                const year = appointmentDate.getFullYear();
                const finalDate = date + "/" + month + "/" + year;
                return finalDate;
              } %> 
            </table>
            <% if (showPopup) { %>
              <form action="/closePopup" method="post">
              <div id="popup_box">
                <div id='userName' class='btn blue'>Name: <%= userDetails.firstName +" "+userDetails.lastName  %></div>
                <div id='carName' class='btn blue'>Car Name: <%= userDetails.carDetails.make %> </div>
                <div id='carBrand' class='btn blue'>Car Brand: <%= userDetails.carDetails.model %> </div>
                <div id='carYear' class='btn blue'>Car Year: <%= userDetails.carDetails.year %> </div>
                <div id='carNo' class='btn blue'>Plate Number: <%= userDetails.carDetails.plateNo %> </div>
                <div id='comment' class='btn blue'>Comment: <input type="" </div>
                <div><input type="submit" value="Submit" id="closePopup" /></div>
              </div>
            </form>
            <% } %>
            </div>
          </div>
        </div>
      </div>
    </header>
    <!-- Footer-->
    <%- include("layouts/footer") -%> <%- include("layouts/scripts") -%>
    <!-- SCRIPTS-->
  </body>
</html>
